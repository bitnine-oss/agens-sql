<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>대기 서버 설정</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="Agens SQL 1.0 문서"
HREF="index.html"><LINK
REL="UP"
TITLE="복구 환경설정"
HREF="recovery-config.html"><LINK
REL="PREVIOUS"
TITLE="복구 시점 설정"
HREF="recovery-target-settings.html"><LINK
REL="NEXT"
TITLE="데이터베이스 성능 모니터링"
HREF="monitoring.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=UTF-8"><META
name="viewport"
content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width"><META
NAME="creation"
CONTENT="2015-06-29T09:12:38"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>Agens SQL 1.0 문서</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="복구 시점 설정"
HREF="recovery-target-settings.html"
ACCESSKEY="P"
>이전</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="recovery-config.html"
ACCESSKEY="U"
>위로</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>장 10. 복구 환경설정</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="데이터베이스 성능 모니터링"
HREF="monitoring.html"
ACCESSKEY="N"
>다음</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="STANDBY-SETTINGS"
>10.3. 대기 서버 설정</A
></H1
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><A
NAME="STANDBY-MODE"
></A
><TT
CLASS="VARNAME"
>standby_mode</TT
> (<TT
CLASS="TYPE"
>boolean</TT
>)</DT
><DD
><P
>                  <SPAN
CLASS="PRODUCTNAME"
>Agens SQL</SPAN
> 서버를 대기 전용(standby) 서버로 
                  운영 하고자 할 때 이 값을 <TT
CLASS="LITERAL"
>on</TT
>으로 설정한다.
                  이렇게 하면 복구할 WAL 파일을 모두 서버에 적용하고 나서
                  <TT
CLASS="VARNAME"
>primary_conninfo</TT
> 접속 정보로 운영 서버로 접속하면 
                  운영 서버에서 반영된 트랜잭션을 대기 서버에도 그대로 
                  반영한다. 운영 서버와의 접속이 끊기면 다시 <TT
CLASS="VARNAME"
>restore_command</TT
>
                  설정에 지정한 명령을 이용해서 다시 대기 서버 쪽에 있는 
                  WAL 파일들을 반영한다. 이런 작업을 반복해서 
                  운영 서버의 대기 서버로 운영할 수 있다.
         </P
></DD
><DT
><A
NAME="PRIMARY-CONNINFO"
></A
><TT
CLASS="VARNAME"
>primary_conninfo</TT
> (<TT
CLASS="TYPE"
>문자열</TT
>)</DT
><DD
><P
>                  운영 서버(primary server, master server)의 접속 정보. 
                  여기서 사용할 수 있는 접속 환경은 표준 접속 방식과 동일하므로 
                  접속에 관련된 모든 환경 변수들을 그대로 사용할 수 있다. 
                  사용 우선 순위도 동일하다. 환경 변수가 지정되어 있고 
                  이 문자열에 지정되어 있지 않으면 환경 변수 값을 사용하고, 
                  환경 변수도 지정돼 있지 않으면 기본값을 사용한다.
         </P
><P
>                  위 <TT
CLASS="VARNAME"
>standby_mode</TT
> 설정값을 <TT
CLASS="LITERAL"
>on</TT
>으로 
                  설정했으면, 이 접속 정보 문자열에는 최소한 운영 서버의 호스트 이름(또는 주소)는 지정해야한다.
          포트가 기본값이라면, 생략해도 된다.
                  접속하려는 사용자가 계정은 운영 서버에 있어야하며, 해당 계정이 운영 서버로 접속해서 
                  복제 작업을 할 수 있는 권한이 있어야한다. 
                  (<A
HREF="warm-standby.html#STREAMING-REPLICATION-AUTHENTICATION"
>9.2.5.1절</A
> 참조)
                  비밀번호 인증이 필요하면, <TT
CLASS="VARNAME"
>primary_conninfo</TT
> 문자열에 지정하든가 
                  대기 서버의 <TT
CLASS="FILENAME"
>~/.pgpass</TT
> 파일에 데이터베이스 이름을 
                  <TT
CLASS="LITERAL"
>replication</TT
>으로 지정하고, 비밀번호를 등록해서 사용한다.
          <TT
CLASS="VARNAME"
>primary_conninfo</TT
> 설정값에는 접속할 데이터베이스 이름은 지정하지 않는다.
         </P
><P
>          <TT
CLASS="VARNAME"
>standby_mode</TT
> 설정값이 <TT
CLASS="LITERAL"
>off</TT
> 상태면, 이 설정은 무시된다.
         </P
></DD
><DT
><A
NAME="TRIGGER-FILE"
></A
><TT
CLASS="VARNAME"
>trigger_file</TT
> (<TT
CLASS="TYPE"
>문자열</TT
>)</DT
><DD
><P
>                  대기 상태가 끝났음을 알리는 파일 이름을 지정한다.
                  이 파일이 있으면 대기 모드 상태를 끝내고 독립 운영 서버로 실행환경을 바꾼다.
                  이 파일 이름을 지정하지 않으면 <TT
CLASS="COMMAND"
>pg_ctl promote</TT
> 명령으로 
                  대기 모드를 끝낼 수 있다.
                  <TT
CLASS="VARNAME"
>standby_mode</TT
> 설정값이 <TT
CLASS="LITERAL"
>off</TT
> 상태면 이 설정은 무시된다.
         </P
></DD
><DT
><A
NAME="RECOVERY-MIN-APPLY-DELAY"
></A
><TT
CLASS="VARNAME"
>recovery_min_apply_delay</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
      </DT
><DD
><P
>        기본적으로 대기 서버는 운영서버의 WAL 레코드를 최대한 빠르게 복원한다. 지연된 데이터 사본을 이용해 데이터 손실 에러를 다양한 방식으로 해결할 수 있다. 
        이 매개 변수는 지정된 시간만큼 복구를 지연하게 하고, 시간 단위는 기본적으로 밀리 세컨드이다. 
        예를 들어 매개 변수를 <TT
CLASS="LITERAL"
>5min</TT
>으로 지정하면, 대기 서버는 시스템 시각이 적어도 마스터 서버에 보고된 커밋 시간보다 5분 지났을 때 각 트랜잭션 커밋을 리플레이 한다. 
       </P
><P
>        서버 간 리플리케이션 지연이 이 매개변수의 값을 초과할 수도 있다. 지연 시간은 마스터 서버에 쓰인 WAL timestamp와 현재 대기 서버의 시간 차이를 뜻한다. 
        네트워크나 지속적인 리플리케이션 설정으로 인한 전송 상의 지연 시간은 실제 대기 시간을 대폭 줄여 준다. 
        마스터 서버와 대기 서버간 시스템 시간이 동기화되지 않으면 예상보다 일찍 레코드를 복구할 수 있다. 
        서버간 시간 편차를 이용하는 것보다 매개변수를 잘 설정하는 것이 더 유용하다. 마스터 서버와 대기 서버의 타임존은 다르게 설정해야 한다.
       </P
><P
>        지연은 COMMIT과 복원 시점인 WAL 레코드에서만 발생한다. 다른 레코드들은 지정한 지연 시간보다 일찍 리플레이 되는데, 복구 충돌이 더 자주 발생할 가능성도 있지만 MVCC에서는 큰 문제가 되지 않는다.
       </P
><P
>        지연은 대기 서버가 promote되거나 trigger될 때까지 발생한다. 그리고 나서 대기 서버는 대기하는 것을 멈추고 복구를 종료한다.
       </P
><P
>        이 매개변수는 스트리밍 리플리케이션 배치 용도로 만들어졌지만, 모든 경우에 적용된다. 동기적인 리플리케이션은 영향을 받지 않는데, 트랜잭션 커밋을 동기적으로 요청하는 설정이 없기 때문이다. 
        <TT
CLASS="VARNAME"
>hot_standby_feedback</TT
>은 이 기능을 사용하면 지연되어 마스터 서버에 과부하가 걸릴 수 있으므로 두 매개변수를 적절히 사용해야 한다.
       </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="recovery-target-settings.html"
ACCESSKEY="P"
>이전</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>처음으로</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="monitoring.html"
ACCESSKEY="N"
>다음</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>복구 시점 설정</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="recovery-config.html"
ACCESSKEY="U"
>위로</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>데이터베이스 성능 모니터링</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>