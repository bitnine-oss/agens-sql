<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>데이터베이스 서버 시작</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="Agens SQL 1.0 문서"
HREF="index.html"><LINK
REL="UP"
TITLE="서버 설정 및 운용"
HREF="runtime.html"><LINK
REL="PREVIOUS"
TITLE="데이터베이스 클러스터 생성"
HREF="creating-cluster.html"><LINK
REL="NEXT"
TITLE="커널 리소스 관리"
HREF="kernel-resources.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=UTF-8"><META
name="viewport"
content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width"><META
NAME="creation"
CONTENT="2015-06-30T08:52:27"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>Agens SQL 1.0 문서</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="데이터베이스 클러스터 생성"
HREF="creating-cluster.html"
ACCESSKEY="P"
>이전</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="runtime.html"
ACCESSKEY="U"
>위로</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>장 1. 서버 설정 및 운용</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="커널 리소스 관리"
HREF="kernel-resources.html"
ACCESSKEY="N"
>다음</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="SERVER-START"
>1.3. 데이터베이스 서버 시작</A
></H1
><P
>   데이터베이스에 액세스하기 전에 데이터베이스 서버를 시작해야 한다. 데이터베이스 서버 프로그램을 <TT
CLASS="COMMAND"
>agens</TT
>라고 한다. 
   <TT
CLASS="COMMAND"
>agens</TT
>프로그램은 사용하려는 데이터 위치를 알고 있어야 한다. 
   이는 <TT
CLASS="OPTION"
>-D</TT
> 옵션으로 가능하다. 따라서 서버를 시작하는 가장 손쉬운 방법은 다음과 같이 하는 것이다.
</P><PRE
CLASS="SCREEN"
><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>agens -D /usr/local/pgsql/data</KBD
></PRE
><P>
   이렇게 하면 서버가 포그라운드에서 실행된다. 이는 <SPAN
CLASS="PRODUCTNAME"
>Agens SQL</SPAN
> 사용자 계정으로 로그인한 상태에서 해야 한다. 
   <TT
CLASS="OPTION"
>-D</TT
>가 없으면 이름이 환경 변수 <TT
CLASS="ENVAR"
>PGDATA</TT
>인 데이터 디렉토리를 서버가 사용하려고 한다. 
   해당 변수가 제공되지 않으면 실패하게 된다.</P
><P
>   보통은 백그라운드에서 <TT
CLASS="COMMAND"
>agens</TT
>를 시작하는 것이 좋다. 이것의 경우 일반적인 Unix 쉘 구문을 사용한다.
</P><PRE
CLASS="SCREEN"
><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>agens -D /usr/local/pgsql/data &gt;logfile 2&gt;&amp;1 &amp;</KBD
></PRE
><P>
   위와 같이 서버의 <SPAN
CLASS="SYSTEMITEM"
>stdout</SPAN
> 및 <SPAN
CLASS="SYSTEMITEM"
>stderr</SPAN
> 출력을 어딘가에 저장해 놓는 것이 중요하다. 
   그러면 감사 및 문제 진단 시 도움이 된다. (로그 파일 처리에 대한 자세한 내용은 <A
HREF="logfile-maintenance.html"
>7.3절</A
> 참조)</P
><P
>   <TT
CLASS="COMMAND"
>agens</TT
> 프로그램에는 다른 커맨드라인 옵션도 많이 있다. 자세한 내용은 agens 참조 페이지 및 아래의 runtime-config 을 참조 바란다.</P
><P
>   쉘 구문은 지루하고 따분하다. 따라서 일부 작업을 단순화할 수 있는 래퍼 프로그램 
   이 제공된다. 예:
</P><PRE
CLASS="PROGRAMLISTING"
>pg_ctl start -l logfile</PRE
><P>
   이것은 서버를 백그라운드에서 시작하고 출력을 지명된 로그 파일로 출력한다. 
   <TT
CLASS="OPTION"
>-D</TT
> 옵션은 <TT
CLASS="COMMAND"
>agens</TT
>에서 사용된 것과 의미가 동일하다. 
   <TT
CLASS="COMMAND"
>pg_ctl</TT
>으로도 서버를 중지할 수 있다.</P
><P
>   보통은, 컴퓨터 부팅 시 데이터베이스 서버도 시작하는 것이 일반적이다. 
    자동 시작 스크립트는 운영 체제마다 다르다. 
   <SPAN
CLASS="PRODUCTNAME"
>Agens SQL</SPAN
>에서 배포되는 몇 가지 스크립트가 <TT
CLASS="FILENAME"
>contrib/start-scripts</TT
> 디렉토리에 있다. 
   하나를 설치하려면 루트 권한이 필요하다.
  </P
><P
>   시스템이 다르면 부팅 시 데몬을 시작하기 위한 규칙(convention)도 달라진다. 다수의 시스템에 <TT
CLASS="FILENAME"
>/etc/rc.local</TT
> 또는
   <TT
CLASS="FILENAME"
>/etc/rc.d/rc.local</TT
> 파일이 있다. 그 외에는 <TT
CLASS="FILENAME"
>init.d</TT
> 또는 <TT
CLASS="FILENAME"
>rc.d</TT
> 디렉토리를 사용한다. 
   서버는 <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>루트</I
></SPAN
> 또는 다른 사용자가 아닌 <SPAN
CLASS="PRODUCTNAME"
>Agens SQL</SPAN
> 사용자 계정으로 실행해야 한다. 그러므로 
   <TT
CLASS="LITERAL"
>su agens -c '...'</TT
> 류의 명령을 사용해야 한다. 예를 들면,
</P><PRE
CLASS="PROGRAMLISTING"
>su agens -c 'pg_ctl start -D /usr/local/pgsql/data -l serverlog'</PRE
><P>
  </P
><P
>   운영 체제별로 특수한 몇 가지 예시는 다음과 같다. (각각의 경우 적절한 설치 디렉토리와 사용자 이름을 사용해야 하며, 여기서는 일반적인 값을 사용한다.)

<P
></P
></P><UL
><LI
><P
>      <SPAN
CLASS="PRODUCTNAME"
>FreeBSD</SPAN
>의 경우 <SPAN
CLASS="PRODUCTNAME"
>Agens SQL</SPAN
> 소스 배포에서 
      <TT
CLASS="FILENAME"
>contrib/start-scripts/freebsd</TT
> 파일을 검토해야 한다.
      
     </P
></LI
><LI
><P
>      <SPAN
CLASS="PRODUCTNAME"
>OpenBSD</SPAN
>에서 다음 라인을 <TT
CLASS="FILENAME"
>/etc/rc.local</TT
> 파일에 추가해야 한다.
      
</P><PRE
CLASS="PROGRAMLISTING"
>if [ -x /usr/local/pgsql/bin/pg_ctl -a -x /usr/local/pgsql/bin/agens ]; then
    su -l agens -c '/usr/local/pgsql/bin/pg_ctl start -s -l /var/Agens SQL/log -D /usr/local/pgsql/data'
    echo -n ' Agens SQL'
fi</PRE
><P>
     </P
></LI
><LI
><P
>      <SPAN
CLASS="PRODUCTNAME"
>Linux</SPAN
> 시스템에서는
      
</P><PRE
CLASS="PROGRAMLISTING"
>/usr/local/pgsql/bin/pg_ctl start -l logfile -D /usr/local/pgsql/data</PRE
><P>
      를 <TT
CLASS="FILENAME"
>/etc/rc.d/rc.local</TT
>
      또는 <TT
CLASS="FILENAME"
>/etc/rc.local</TT
>에 추가하거나 <SPAN
CLASS="PRODUCTNAME"
>Agens SQL</SPAN
> 소스 배포에서 
      <TT
CLASS="FILENAME"
>contrib/start-scripts/linux</TT
> 파일을 검토해야 한다.
     </P
></LI
><LI
><P
>      <SPAN
CLASS="PRODUCTNAME"
>NetBSD</SPAN
>에서는 기본 설정에 따라 
      <SPAN
CLASS="PRODUCTNAME"
>FreeBSD</SPAN
> 또는
      <SPAN
CLASS="PRODUCTNAME"
>Linux</SPAN
> 시작 스크립트를 사용해야 한다.
      
     </P
></LI
><LI
><P
>      <SPAN
CLASS="PRODUCTNAME"
>Solaris</SPAN
>에서는 다음 라인이 포함된 
      <TT
CLASS="FILENAME"
>/etc/init.d/postgresql</TT
> 파일을 생성해야 한다.
      
</P><PRE
CLASS="PROGRAMLISTING"
>su - agens -c "/usr/local/pgsql/bin/pg_ctl start -l logfile -D /usr/local/pgsql/data"</PRE
><P>
      그런 다음, <TT
CLASS="FILENAME"
>S99Agens SQL</TT
>로써 <TT
CLASS="FILENAME"
>/etc/rc3.d</TT
>에 심볼릭 링크를 생성해야 한다.
     </P
></LI
></UL
><P>

  </P
><P
>    서버 실행 중에 <ACRONYM
CLASS="ACRONYM"
>PID</ACRONYM
>는 데이터 디렉토리의 <TT
CLASS="FILENAME"
>postmaster.pid</TT
> 파일에 저장된다. 
    이것은 동일한 데이터 디렉토리에서 실행되는 다중 서버 인스턴스를 방지하는 데 사용되고, 서버를 셧다운하는 데에도 사용될 수 있다.
   </P
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="SERVER-START-FAILURES"
>1.3.1. 서버 시작 실패</A
></H2
><P
>     서버 시작 실패에는 몇 가지 공통된 원인이 있다. 서버의 로그 파일을 확인하거나 직접 시작해서(표준 출력 또는 표준 에러를 리다이렉트하지 않고) 
     에러 메시지를 확인해야 한다. 아래는 몇 가지 공통된 에러 메시지를 자세히 설명한다.
    </P
><P
></P><PRE
CLASS="SCREEN"
><SAMP
CLASS="COMPUTEROUTPUT"
>LOG:  could not bind IPv4 socket: Address already in use
HINT:  Is another postmaster already running on port 5432? If not, wait a few seconds and retry.
FATAL:  could not create TCP/IP listen socket</SAMP
></PRE
><P>
     일반적으로 이것은 서버가 이미 실행되고 있는 포트에서 사용자가 다른 서버를 시작하려고 했음을 의미한다. 
     단, 커널 에러 메시지가 <SAMP
CLASS="COMPUTEROUTPUT"
>Address already in use</SAMP
>가 아니면 다른 문제일 가능성이 있다. 
     예를 들면, 예약된 포트 번호에서 서버를 시작하려고 하면 다음과 같이 할 것이다.
</P><PRE
CLASS="SCREEN"
><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>agens -p 666</KBD
>
<SAMP
CLASS="COMPUTEROUTPUT"
>LOG:  could not bind IPv4 socket: Permission denied
HINT:  Is another postmaster already running on port 666? If not, wait a few seconds and retry.
FATAL:  could not create TCP/IP listen socket</SAMP
></PRE
><P>
    </P
><P
>    메시지는 다음과 같이 나타난다.
</P><PRE
CLASS="SCREEN"
>FATAL:  could not create shared memory segment: Invalid argument
DETAIL:  Failed system call was shmget(key=5440001, size=4011376640, 03600).</PRE
><P>
     이것은 공유 메모리 크기에 대한 커널 제한이 <SPAN
CLASS="PRODUCTNAME"
>Agens SQL</SPAN
>이 생성하려고 하는 작업 영역보다 작다는 것을 의미하는 것일 수 있다.
     (이 예시에서 4011376640바이트)
     또는 커널에 환경 설정된 System-V-style 공유 메모리가 일절 지원되지 않는다는 것을 의미할 수도 있다. 
     임시 해결책으로 버퍼 수를 정상보다 작게 해서 서버 시작을 시도해볼 수 있다(<A
HREF="runtime-config-resource.html#GUC-SHARED-BUFFERS"
>shared_buffers</A
>). 
     결국에는 허용된 공유 메모리 크기를 늘리기 위해 사용자는 다시 커널 환경 설정을 할 수도 있다. 
     또한 동일한 머신에서 다중 서버를 시작하려는 경우 총 요청 공간이 커널 제한을 초과하면 이 메시지가 나타날 수도 있다.
    </P
><P
>     에러가 다음과 같을 수 있다.
</P><PRE
CLASS="SCREEN"
>FATAL:  could not create semaphores: No space left on device
DETAIL:  Failed system call was semget(5440126, 17, 03600).</PRE
><P>
     이것은 사용자의 디스크 공간이 소진되었음을 의미하지 <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>않는다</I
></SPAN
>. 
     이것은 <SPAN
CLASS="SYSTEMITEM"
>System V</SPAN
> 세마포어에 대한 커널 수 제한이 생성하려는 <SPAN
CLASS="PRODUCTNAME"
>Agens SQL</SPAN
>의 수보다 작다는 것을 의미한다. 
     위와 마찬가지로, 허용된 연결 수(<A
HREF="runtime-config-connection.html#GUC-MAX-CONNECTIONS"
>max_connections</A
>)를 줄여서 서버를 시작함으로써 문제를 해결할 수 있지만, 
     결국에는 커널 제한을 늘리는 것이 좋다.
    </P
><P
>     <SPAN
CLASS="QUOTE"
>"illegal system call"</SPAN
> 에러가 나타난 경우 공유 메모리 또는 세마포어가 사용자의 커널에서 일절 지원되지 않는 것일 수 있다. 
     이런 경우 유일한 방법은 커널을 다시 환경 설정하는 것뿐이다.
    </P
><P
>     <SPAN
CLASS="SYSTEMITEM"
>System V</SPAN
>
     <ACRONYM
CLASS="ACRONYM"
>IPC</ACRONYM
> 기능 환경 설정에 대한 자세한 내용은 <A
HREF="kernel-resources.html#SYSVIPC"
>1.4.1절</A
>에 나와 있다.
    </P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="CLIENT-CONNECTION-PROBLEMS"
>1.3.2. 클라이언트 연결 문제</A
></H2
><P
>     클라이언트 측에서 발생 가능한 에러 조건은 다양하고 애플리케이션에 의존적이지만, 그 중 몇 가지는 서버가 시작되는 것과 직접적인 관련이 있다. 
     아래 조건 이외는 각 클라이언트 애플리케이션에 맞춰서 문서화되어야 한다.
    </P
><P
></P><PRE
CLASS="SCREEN"
>psql: could not connect to server: Connection refused
        Is the server running on host "server.joe.com" and accepting
        TCP/IP connections on port 5432?</PRE
><P>
     이것은 일반적인 <SPAN
CLASS="QUOTE"
>"I couldn't find a server to talk to"</SPAN
> 실패이다. 
     TCP/IP 통신을 시도하면 위와 같이 보인다. TCP/IP 연결이 가능하게 서버를 환경 설정하는 것을 잊어버렸을 때 발생한다.
    </P
><P
>     또, 로컬 서버에 대한 Unix 도메인 소켓 통신을 시도할 때 발생할 수 있다.
</P><PRE
CLASS="SCREEN"
>psql: could not connect to server: No such file or directory
        Is the server running locally and accepting
        connections on Unix domain socket "/tmp/.s.PGSQL.5432"?</PRE
><P>
    </P
><P
>     마지막 라인은 클라이언트가 올바른 곳으로 연결을 시도하고 있는지 확인하는 메시지이다.
     사실상 실행 중인 서버가 없는 경우 커널 에러 메시지는 보통 
     <SAMP
CLASS="COMPUTEROUTPUT"
>Connection refused</SAMP
> 또는 <SAMP
CLASS="COMPUTEROUTPUT"
>No such file or directory</SAMP
> 중 하나이다. 
     (<SAMP
CLASS="COMPUTEROUTPUT"
>Connection refused</SAMP
>는 서버가 사용자의 연결 요청을 접수했는데 거부했다는 뜻이 <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>아니다.</I
></SPAN
> 해당 사례는 <A
HREF="client-authentication-problems.html"
>3.4절</A
>에 표시된 대로 다른 메시지가 나타난다.) 
     <SAMP
CLASS="COMPUTEROUTPUT"
>Connection timed out</SAMP
> 같은 에러 메시지는 네트워크 연결성 부족 문제를 뜻하는 것일 수 있다.
    </P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="creating-cluster.html"
ACCESSKEY="P"
>이전</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>처음으로</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="kernel-resources.html"
ACCESSKEY="N"
>다음</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>데이터베이스 클러스터 생성</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="runtime.html"
ACCESSKEY="U"
>위로</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>커널 리소스 관리</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>