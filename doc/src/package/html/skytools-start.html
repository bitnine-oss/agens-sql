<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Quick Start</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="Agens SQL 1.0 문서"
HREF="index.html"><LINK
REL="UP"
TITLE="Skytools"
HREF="skytools.html"><LINK
REL="PREVIOUS"
TITLE="Skytools란?"
HREF="skytools-info.html"><LINK
REL="NEXT"
TITLE="pgpool-II"
HREF="pgpoolii.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=UTF-8"><META
name="viewport"
content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width"><META
NAME="creation"
CONTENT="2015-06-29T09:12:55"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>Agens SQL 1.0 문서</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="Skytools란?"
HREF="skytools-info.html"
ACCESSKEY="P"
>이전</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="skytools.html"
ACCESSKEY="U"
>위로</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>장 3. Skytools</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="pgpool-II"
HREF="pgpoolii.html"
ACCESSKEY="N"
>다음</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="SKYTOOLS-START"
>3.2. Quick Start</A
></H1
><P
>            이번 절에서는 <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
>의 Ticker 데몬을 구동하는 방법과 <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
>를 생성하는 방법에 대해서 다룬다.
        </P
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="SKYTOOLS-TICKER"
>3.2.1. Ticker 데몬 구동</A
></H2
><P
>                    Consumer가 <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
>에 담긴 event를 사용하기 위해서는 <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
>의 Ticker 데몬이 동작하고 있어야 한다. Ticker는 <SPAN
CLASS="PRODUCTNAME"
>Skytools</SPAN
> 3.x 버전으로 업그레이드 되면서 <TT
CLASS="FILENAME"
>pgqd</TT
>으로 바뀌었다. Ticker 데몬을 동작하는 방법은 간단하다. 하지만 시스템 설정을 바꿔줄 필요가 있다. 
                </P
><P
>                    Ticker 데몬의 명령어는 다음 명령어를 실행한 결과로 쉽게 확인 할 수 있다.
                </P
><P
>                    </P><PRE
CLASS="PROGRAMLISTING"
><SAMP
CLASS="PROMPT"
>localhost</SAMP
> $ <KBD
CLASS="USERINPUT"
><TT
CLASS="COMMAND"
>pgqd --help</TT
></KBD
>
<SAMP
CLASS="COMPUTEROUTPUT"
>usage: pgq-ticker [switches] config.file
Switches:
  -v        Increase verbosity
  -q        No output to console
  -d        Daemonize
  -h        Show help
  -V        Show version
 --ini      Show sample config file
  -s        Stop - send SIGINT to running process
  -k        Kill - send SIGTERM to running process
  -r        Reload - send SIGHUP to running process</SAMP
></PRE
><P>
                </P
><P
>                    데몬의 설정 파일 예시 또한 제공 되고 있다. 다음은 Ticker 데몬의 설정파일이다.
                </P
><P
>                    </P><PRE
CLASS="PROGRAMLISTING"
>[pgqd]
job_name = pgqd_ticker
db = dbname=postgres

# where to log
logfile = /home/postgres/9.4/pgsql/data/pg_log/pgqd_ticker.log

# pidfile
pidfile = /home/postgres/9.4/pgsql/data/pg_log/pgqd_ticker.pid

## optional parameters ##

# libpq connect string without dbname=
#base_connstr =

# startup db to query other databases
#initial_database = template1

# limit ticker to specific databases
#database_list =

# log into syslog
#syslog = 1
#syslog_ident = pgqd

## optional timeouts ##

# how often to check for new databases
#check_period = 60

# how often to flush retry queue
#retry_period = 30

# how often to do maintentance
#maint_period = 120

# how often to run ticker
#ticker_period = 1</PRE
><P>
                </P
><P
>                    <TT
CLASS="FILENAME"
>pgqd.ini</TT
>라는 설정 파일을 만들어서 Ticker 데몬을 실행 한 후 다음과 같은 명령어로 동작 되고 있는 것을 확인할 수 있다.
                </P
><P
>                    </P><PRE
CLASS="PROGRAMLISTING"
><SAMP
CLASS="PROMPT"
>localhost</SAMP
> $ <KBD
CLASS="USERINPUT"
><TT
CLASS="COMMAND"
>ps -ef | grep pgqd</TT
></KBD
>
<SAMP
CLASS="COMPUTEROUTPUT"
>postgres 25249     1  0 07:17 ?        00:00:00 pgqd -d ./pgqd.ini</SAMP
></PRE
><P>
                </P
><P
>                    Ticker 데몬이 정상동작 한다면 <TT
CLASS="FILENAME"
>pgqd_ticker.log</TT
>에는 다음과 같이 표기 될 것이다.
                </P
><P
>                    </P><PRE
CLASS="PROGRAMLISTING"
>2015-06-24 08:34:55.710 25249 LOG postgres: pgq version ok: 3.2.6
2015-06-24 08:35:24.185 25249 LOG {ticks: 30, maint: 1, retry: 0}
2015-06-24 08:35:54.186 25249 LOG {ticks: 30, maint: 0, retry: 0}
2015-06-24 08:36:24.187 25249 LOG {ticks: 30, maint: 0, retry: 0}
2015-06-24 08:36:54.188 25249 LOG {ticks: 30, maint: 0, retry: 0}
2015-06-24 08:37:24.188 25249 LOG {ticks: 30, maint: 1, retry: 0}
2015-06-24 08:37:54.189 25249 LOG {ticks: 30, maint: 0, retry: 0}
2015-06-24 08:38:24.189 25249 LOG {ticks: 30, maint: 0, retry: 0}</PRE
><P>
                </P
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="SKYTOOLS-MAKE-QUEUE"
>3.2.2. <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
> 생성</A
></H2
><P
>                    <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
>는 extension 모듈이기 때문에 <TT
CLASS="COMMAND"
>CREATE EXTENSION</TT
> 명령을 통해 object을 로드 해주어야 한다. 다음의 간단한 과정을 통해 <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
> object를 로드하고 <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
>를 생성할 수 있다.
                </P
><P
></P
><OL
TYPE="1"
><LI
><P
>                            <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
> extension 모듈 로드.
                        </P
><P
>                            <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
>은 <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>의 확장 모듈이기 때문에 <TT
CLASS="COMMAND"
>CREATE EXTENSION</TT
> 명령을 사용하여 <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
> 스키마를 로드해야한다. 실행 예제는 아래와 같다.
                        </P
><P
>                            </P><PRE
CLASS="PROGRAMLISTING"
><SAMP
CLASS="PROMPT"
>postgres</SAMP
>=# <KBD
CLASS="USERINPUT"
><TT
CLASS="COMMAND"
>CREATE EXTENSION pgq;</TT
></KBD
>
<SAMP
CLASS="COMPUTEROUTPUT"
>CREATE EXTENSION</SAMP
></PRE
><P>
                        </P
></LI
><LI
><P
>                            <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
> 큐 생성.
                        </P
><P
>                            <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
> 큐를 생성하기 위해서는 <TT
CLASS="COMMAND"
>SELECT</TT
> 명령어를 사용해야 한다. 실행 예제는 아래와 같다.
                        </P
><P
>                            </P><PRE
CLASS="PROGRAMLISTING"
><SAMP
CLASS="PROMPT"
>postgres</SAMP
>=# <KBD
CLASS="USERINPUT"
><TT
CLASS="COMMAND"
>SELECT * FROM pgq.create_queue('my_first_queue');</TT
></KBD
>
<SAMP
CLASS="COMPUTEROUTPUT"
> create_queue 
--------------
            1
(1 row)</SAMP
></PRE
><P>
                        </P
></LI
><LI
><P
>                            <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
> 큐 생성확인.
                        </P
><P
>                            <SPAN
CLASS="PRODUCTNAME"
>PGQ</SPAN
>은 테이블을 생성하기 때문에 다음의 명령어로 확인이 가능하다.
                        </P
><P
>                            </P><PRE
CLASS="PROGRAMLISTING"
><SAMP
CLASS="PROMPT"
>postgres</SAMP
>=# <KBD
CLASS="USERINPUT"
><TT
CLASS="COMMAND"
>\dt+ pgq.*;</TT
></KBD
>
<SAMP
CLASS="COMPUTEROUTPUT"
>                           List of relations
 Schema |      Name      | Type  |  Owner   |    Size    | Description 
--------+----------------+-------+----------+------------+-------------
 pgq    | consumer       | table | postgres | 8192 bytes | 
 pgq    | event_1        | table | postgres | 8192 bytes | 
 pgq    | event_1_0      | table | postgres | 8192 bytes | 
 pgq    | event_1_1      | table | postgres | 8192 bytes | 
 pgq    | event_1_2      | table | postgres | 8192 bytes | 
 pgq    | event_template | table | postgres | 8192 bytes | 
 pgq    | queue          | table | postgres | 16 kB      | 
 pgq    | retry_queue    | table | postgres | 8192 bytes | 
 pgq    | subscription   | table | postgres | 0 bytes    | 
 pgq    | tick           | table | postgres | 48 kB      | 
(10 rows)</SAMP
></PRE
><P>
                        </P
></LI
></OL
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="skytools-info.html"
ACCESSKEY="P"
>이전</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>처음으로</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="pgpoolii.html"
ACCESSKEY="N"
>다음</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><SPAN
CLASS="PRODUCTNAME"
>Skytools</SPAN
>란?</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="skytools.html"
ACCESSKEY="U"
>위로</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>pgpool-II</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>